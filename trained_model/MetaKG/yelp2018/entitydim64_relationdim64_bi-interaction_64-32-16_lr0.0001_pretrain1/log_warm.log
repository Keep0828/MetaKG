2021-06-05 03:52:39,167 - root - INFO - Namespace(K=20, K1=10, aggregation_type='bi-interaction', cf_batch_size=16, cf_l2loss_lambda=1e-05, cf_print_every=100, conv_dim_list='[64, 32, 16]', data_dir='datasets/', data_name='yelp2018', entity_dim=64, evaluate_every=1, fine_tuning_batch_size=16, kg_batch_size=1024, kg_l2loss_lambda=1e-05, kg_print_every=100, local_lr=0.0001, local_rank=0, lr=0.0001, mess_dropout='[0.1, 0.1, 0.1]', n_epoch=1000, pretrain_embedding_dir='datasets/pretrain/', pretrain_model_path='trained_model/model.pth', relation_dim=64, save_dir='trained_model/KGAT/yelp2018/entitydim64_relationdim64_bi-interaction_64-32-16_lr0.0001_pretrain1/', seed=123, stopping_steps=30, test_batch_size=5000, use_pretrain=1)
2021-06-05 03:52:44,450 - numexpr.utils - INFO - Note: NumExpr detected 20 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2021-06-05 03:52:44,450 - numexpr.utils - INFO - NumExpr defaulting to 8 threads.
2021-06-05 03:57:59,701 - root - INFO - n_users:            45919
2021-06-05 03:57:59,701 - root - INFO - n_items:            45538
2021-06-05 03:57:59,701 - root - INFO - n_entities:         136499
2021-06-05 03:57:59,701 - root - INFO - n_users_entities:   182418
2021-06-05 03:57:59,701 - root - INFO - n_relations:        86
2021-06-05 03:57:59,701 - root - INFO - n_cf_train:         357219
2021-06-05 03:57:59,701 - root - INFO - n_cf_test:          237300
2021-06-05 03:57:59,702 - root - INFO - n_kg_train:         4421846
2021-06-05 03:57:59,702 - root - INFO - n_kg_test:          4182008
2021-06-05 04:03:05,600 - root - INFO - n_users:            45919
2021-06-05 04:03:05,600 - root - INFO - n_items:            45538
2021-06-05 04:03:05,600 - root - INFO - n_entities:         136499
2021-06-05 04:03:05,600 - root - INFO - n_users_entities:   182418
2021-06-05 04:03:05,600 - root - INFO - n_relations:        86
2021-06-05 04:03:05,600 - root - INFO - n_cf_train:         38828
2021-06-05 04:03:05,600 - root - INFO - n_cf_test:          26100
2021-06-05 04:03:05,600 - root - INFO - n_kg_train:         3785064
2021-06-05 04:03:05,600 - root - INFO - n_kg_test:          3759608
2021-06-05 04:03:23,115 - root - INFO - KGAT(
  (relation_embed): Embedding(86, 64)
  (entity_user_embed): Embedding(182418, 64)
  (aggregator_layers): ModuleList(
    (0): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (W1): Linear(in_features=64, out_features=64, bias=True)
      (W2): Linear(in_features=64, out_features=64, bias=True)
      (activation): LeakyReLU(negative_slope=0.01)
    )
    (1): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (W1): Linear(in_features=64, out_features=32, bias=True)
      (W2): Linear(in_features=64, out_features=32, bias=True)
      (activation): LeakyReLU(negative_slope=0.01)
    )
    (2): Aggregator(
      (message_dropout): Dropout(p=0.1, inplace=False)
      (W1): Linear(in_features=32, out_features=16, bias=True)
      (W2): Linear(in_features=32, out_features=16, bias=True)
      (activation): LeakyReLU(negative_slope=0.01)
    )
  )
)
2021-06-05 04:03:26,283 - root - INFO - Meta Training: Epoch 0001 Iter 0000 / 1484 | Time 3.1s | Iter Loss 0.8459
2021-06-05 04:07:58,066 - root - INFO - Meta Training: Epoch 0001 Iter 0100 / 1484 | Time 2.7s | Iter Loss 0.6909
2021-06-05 04:12:31,314 - root - INFO - Meta Training: Epoch 0001 Iter 0200 / 1484 | Time 2.7s | Iter Loss 0.8513
2021-06-05 04:17:03,258 - root - INFO - Meta Training: Epoch 0001 Iter 0300 / 1484 | Time 2.7s | Iter Loss 0.5733
2021-06-05 04:21:35,205 - root - INFO - Meta Training: Epoch 0001 Iter 0400 / 1484 | Time 2.7s | Iter Loss 0.4897
2021-06-05 04:26:08,494 - root - INFO - Meta Training: Epoch 0001 Iter 0500 / 1484 | Time 2.7s | Iter Loss 0.5562
2021-06-05 04:30:39,829 - root - INFO - Meta Training: Epoch 0001 Iter 0600 / 1484 | Time 2.7s | Iter Loss 0.5130
2021-06-05 04:35:12,070 - root - INFO - Meta Training: Epoch 0001 Iter 0700 / 1484 | Time 2.7s | Iter Loss 0.4182
2021-06-05 04:39:43,010 - root - INFO - Meta Training: Epoch 0001 Iter 0800 / 1484 | Time 2.7s | Iter Loss 0.4314
2021-06-05 04:44:15,227 - root - INFO - Meta Training: Epoch 0001 Iter 0900 / 1484 | Time 2.7s | Iter Loss 0.5739
2021-06-05 04:48:46,040 - root - INFO - Meta Training: Epoch 0001 Iter 1000 / 1484 | Time 2.7s | Iter Loss 0.4185
2021-06-05 04:53:17,071 - root - INFO - Meta Training: Epoch 0001 Iter 1100 / 1484 | Time 2.7s | Iter Loss 0.6270
2021-06-05 04:57:50,270 - root - INFO - Meta Training: Epoch 0001 Iter 1200 / 1484 | Time 2.7s | Iter Loss 0.2647
2021-06-05 05:02:21,695 - root - INFO - Meta Training: Epoch 0001 Iter 1300 / 1484 | Time 2.7s | Iter Loss 0.3698
2021-06-05 05:06:54,155 - root - INFO - Meta Training: Epoch 0001 Iter 1400 / 1484 | Time 2.7s | Iter Loss 0.3814
2021-06-05 05:10:37,371 - root - INFO - Meta Training: Epoch 0001 Total Iter 1484 | Total Time 4034.2s | Iter Mean Loss 0.5544
2021-06-05 05:10:53,786 - root - INFO - Fine-tuning Evaluation: Epoch 0000 | Total Time 16.4s | Precision10 0.1007 Recall10 0.1007 NDCG10 0.1130 Precision20 0.0776 Recall20 0.1552 NDCG20 0.1432
2021-06-05 05:10:53,841 - root - INFO - Save model on epoch 0000!
2021-06-05 05:11:10,172 - root - INFO - Fine-tuning Evaluation: Epoch 0001 | Total Time 16.3s | Precision10 0.0964 Recall10 0.0964 NDCG10 0.1089 Precision20 0.0754 Recall20 0.1509 NDCG20 0.1390
2021-06-05 05:11:26,497 - root - INFO - Fine-tuning Evaluation: Epoch 0002 | Total Time 16.3s | Precision10 0.0941 Recall10 0.0941 NDCG10 0.1067 Precision20 0.0743 Recall20 0.1485 NDCG20 0.1368
2021-06-05 05:11:42,831 - root - INFO - Fine-tuning Evaluation: Epoch 0003 | Total Time 16.3s | Precision10 0.0931 Recall10 0.0931 NDCG10 0.1054 Precision20 0.0738 Recall20 0.1476 NDCG20 0.1356
2021-06-05 05:11:59,164 - root - INFO - Fine-tuning Evaluation: Epoch 0004 | Total Time 16.3s | Precision10 0.0923 Recall10 0.0923 NDCG10 0.1048 Precision20 0.0730 Recall20 0.1461 NDCG20 0.1345
2021-06-05 05:12:15,493 - root - INFO - Fine-tuning Evaluation: Epoch 0005 | Total Time 16.3s | Precision10 0.0914 Recall10 0.0914 NDCG10 0.1040 Precision20 0.0724 Recall20 0.1447 NDCG20 0.1335
2021-06-05 05:12:31,823 - root - INFO - Fine-tuning Evaluation: Epoch 0006 | Total Time 16.3s | Precision10 0.0911 Recall10 0.0911 NDCG10 0.1036 Precision20 0.0722 Recall20 0.1444 NDCG20 0.1331
2021-06-05 05:12:48,150 - root - INFO - Fine-tuning Evaluation: Epoch 0007 | Total Time 16.3s | Precision10 0.0908 Recall10 0.0908 NDCG10 0.1031 Precision20 0.0719 Recall20 0.1439 NDCG20 0.1325
2021-06-05 05:13:04,491 - root - INFO - Fine-tuning Evaluation: Epoch 0008 | Total Time 16.3s | Precision10 0.0912 Recall10 0.0912 NDCG10 0.1031 Precision20 0.0720 Recall20 0.1439 NDCG20 0.1322
2021-06-05 05:13:20,817 - root - INFO - Fine-tuning Evaluation: Epoch 0009 | Total Time 16.3s | Precision10 0.0904 Recall10 0.0904 NDCG10 0.1025 Precision20 0.0718 Recall20 0.1437 NDCG20 0.1320
2021-06-05 05:13:37,149 - root - INFO - Fine-tuning Evaluation: Epoch 0010 | Total Time 16.3s | Precision10 0.0899 Recall10 0.0899 NDCG10 0.1022 Precision20 0.0716 Recall20 0.1433 NDCG20 0.1317
2021-06-05 05:13:54,774 - root - INFO - Fine-tuning Evaluation: Epoch 0011 | Total Time 17.6s | Precision10 0.0896 Recall10 0.0896 NDCG10 0.1016 Precision20 0.0713 Recall20 0.1426 NDCG20 0.1310
2021-06-05 05:14:11,097 - root - INFO - Fine-tuning Evaluation: Epoch 0012 | Total Time 16.3s | Precision10 0.0894 Recall10 0.0894 NDCG10 0.1012 Precision20 0.0710 Recall20 0.1420 NDCG20 0.1303
2021-06-05 05:14:27,429 - root - INFO - Fine-tuning Evaluation: Epoch 0013 | Total Time 16.3s | Precision10 0.0887 Recall10 0.0887 NDCG10 0.1008 Precision20 0.0710 Recall20 0.1420 NDCG20 0.1303
2021-06-05 05:14:43,761 - root - INFO - Fine-tuning Evaluation: Epoch 0014 | Total Time 16.3s | Precision10 0.0894 Recall10 0.0894 NDCG10 0.1011 Precision20 0.0715 Recall20 0.1430 NDCG20 0.1308
2021-06-05 05:15:00,089 - root - INFO - Fine-tuning Evaluation: Epoch 0015 | Total Time 16.3s | Precision10 0.0884 Recall10 0.0884 NDCG10 0.1003 Precision20 0.0706 Recall20 0.1412 NDCG20 0.1294
2021-06-05 05:15:16,424 - root - INFO - Fine-tuning Evaluation: Epoch 0016 | Total Time 16.3s | Precision10 0.0874 Recall10 0.0874 NDCG10 0.0995 Precision20 0.0698 Recall20 0.1396 NDCG20 0.1284
2021-06-05 05:15:32,759 - root - INFO - Fine-tuning Evaluation: Epoch 0017 | Total Time 16.3s | Precision10 0.0872 Recall10 0.0872 NDCG10 0.0993 Precision20 0.0702 Recall20 0.1403 NDCG20 0.1287
2021-06-05 05:15:49,086 - root - INFO - Fine-tuning Evaluation: Epoch 0018 | Total Time 16.3s | Precision10 0.0851 Recall10 0.0851 NDCG10 0.0970 Precision20 0.0683 Recall20 0.1366 NDCG20 0.1255
2021-06-05 05:16:05,410 - root - INFO - Fine-tuning Evaluation: Epoch 0019 | Total Time 16.3s | Precision10 0.0856 Recall10 0.0856 NDCG10 0.0975 Precision20 0.0684 Recall20 0.1369 NDCG20 0.1258
2021-06-05 05:16:21,747 - root - INFO - Fine-tuning Evaluation: Epoch 0020 | Total Time 16.3s | Precision10 0.0856 Recall10 0.0856 NDCG10 0.0973 Precision20 0.0681 Recall20 0.1363 NDCG20 0.1253
2021-06-05 05:16:38,080 - root - INFO - Fine-tuning Evaluation: Epoch 0021 | Total Time 16.3s | Precision10 0.0844 Recall10 0.0844 NDCG10 0.0962 Precision20 0.0670 Recall20 0.1340 NDCG20 0.1235
2021-06-05 05:16:54,413 - root - INFO - Fine-tuning Evaluation: Epoch 0022 | Total Time 16.3s | Precision10 0.0844 Recall10 0.0844 NDCG10 0.0962 Precision20 0.0671 Recall20 0.1343 NDCG20 0.1237
2021-06-05 05:17:10,755 - root - INFO - Fine-tuning Evaluation: Epoch 0023 | Total Time 16.3s | Precision10 0.0850 Recall10 0.0850 NDCG10 0.0970 Precision20 0.0682 Recall20 0.1363 NDCG20 0.1253
2021-06-05 05:17:27,094 - root - INFO - Fine-tuning Evaluation: Epoch 0024 | Total Time 16.3s | Precision10 0.0844 Recall10 0.0844 NDCG10 0.0962 Precision20 0.0678 Recall20 0.1357 NDCG20 0.1245
2021-06-05 05:17:43,429 - root - INFO - Fine-tuning Evaluation: Epoch 0025 | Total Time 16.3s | Precision10 0.0842 Recall10 0.0842 NDCG10 0.0960 Precision20 0.0672 Recall20 0.1344 NDCG20 0.1237
2021-06-05 05:17:59,764 - root - INFO - Fine-tuning Evaluation: Epoch 0026 | Total Time 16.3s | Precision10 0.0857 Recall10 0.0857 NDCG10 0.0977 Precision20 0.0688 Recall20 0.1375 NDCG20 0.1263
2021-06-05 05:18:16,102 - root - INFO - Fine-tuning Evaluation: Epoch 0027 | Total Time 16.3s | Precision10 0.0850 Recall10 0.0850 NDCG10 0.0974 Precision20 0.0682 Recall20 0.1364 NDCG20 0.1258
2021-06-05 05:18:32,450 - root - INFO - Fine-tuning Evaluation: Epoch 0028 | Total Time 16.3s | Precision10 0.0857 Recall10 0.0857 NDCG10 0.0979 Precision20 0.0686 Recall20 0.1372 NDCG20 0.1264
2021-06-05 05:18:48,784 - root - INFO - Fine-tuning Evaluation: Epoch 0029 | Total Time 16.3s | Precision10 0.0841 Recall10 0.0841 NDCG10 0.0962 Precision20 0.0671 Recall20 0.1341 NDCG20 0.1239
2021-06-05 05:19:05,123 - root - INFO - Fine-tuning Evaluation: Epoch 0030 | Total Time 16.3s | Precision10 0.0856 Recall10 0.0856 NDCG10 0.0978 Precision20 0.0684 Recall20 0.1368 NDCG20 0.1261
